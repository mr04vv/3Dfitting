//身長と肩幅を順に測れるようにした
//1画素あたりのサイズ獲得できた
//肩幅を計測できた
//右クリックで初期化
//入力システム統合
//ウエスト（仮）身長，肩幅，ウエスト前からと横からの順に
mport java.awt.*;
import javax.swing.*;

int img_h = 3264;
int img_w = 2448;
int s = 7;
int x=0, y=0;    //座標保持
int count=0;
double height;  //身長
double lengh=0;    //肩幅
double pixel=0;  //1画素あたりのサイズ


void setup() {

  size(1000, 600);

  PImage img1 = loadImage("yuki_side.JPG");
  PImage img2 = loadImage("yuki_front.JPG");

  image(img1, 0, 0, img_w/s, img_h/s);
  image(img2, 2448/s, 0, img_w/s, img_h/s);

  JPanel panel = new JPanel();
  BoxLayout layout = new BoxLayout(panel, BoxLayout.Y_AXIS);
  panel.setLayout(layout);

  panel.add(new JLabel("身長を入力してください"));
  JTextField text1 = new JTextField();
  panel.add(text1);
panel.add(new JLabel("(cm)"));

  int r = JOptionPane.showConfirmDialog(
    null, // オーナーウィンドウ
    panel, // メッセージ
    "身長は？", // ウィンドウタイトル
    JOptionPane.OK_CANCEL_OPTION, // オプション（ボタンの種類）
    JOptionPane.QUESTION_MESSAGE);  // メッセージタイプ（アイコンの種類）

  //println(r);
  //println(text1.getText());

  height = Double.valueOf(text1.getText());
  //String型で入力されたやつをむりやりdoubleに変換

  // println(height);
}

void draw() {

  fill(0, 0, 0);
  noStroke();
  smooth();

  if (mouseButton == LEFT) {
    if (count==0) {              //タッチした時にcountが1
      //     text("身長は"+height+"cm", 25, img1_h/s+50);
      rect(x, y, 4, mouseY-y);
      pixel = height / ((double)mouseY - (double)y);
    } else {
      rect(x, y, mouseX-x, 4);
      lengh = (double)(mouseX-x) * pixel;
    }
  }
}

void mousePressed() {
  if (count==0) {
    rect(mouseX, mouseY, 20, 4);
    rect(mouseX, mouseY, -20, 4);
    x = mouseX;
    y = mouseY;
  } else {
    rect(mouseX, mouseY, 4, 20);
    rect(mouseX, mouseY, 4, -20);
    x = mouseX;
    y = mouseY;
  }
}

void mouseReleased() {
  if (mouseButton == RIGHT) {      //カーソルキャンセル
    count = 0;                                      //countと画面を初期化
    background(204);
    setup();
  } else if (count==0) {
    rect(x, mouseY, 20, 4);
    rect(x, mouseY, -20, 4);
    count++;
  } else if (count==1) {
    rect(mouseX, y, 4, 20);
    rect(mouseX, y, 4, -20);
    String after = String.format("%.2f", lengh);    //小数点第2まで表示
    text("肩幅は"+after+"±1.00"+"cm", 25, img_h/s+50);
    count++;
  } else if (count==2) {
    rect(mouseX, y, 4, 20);
    rect(mouseX, y, 4, -20);
    waist = lengh * 1.5;
    count++;    
  } else if (count==3) {
    rect(mouseX, y, 4, 20);
    rect(mouseX, y, 4, -20);
    waist = waist + lengh*1.5;
    String after = String.format("%.2f", waist);    //小数点第2まで表示
    text("ウエストは"+after+"±1.00"+"cm", 200, img_h/s+50);
    count++;
  }
}
